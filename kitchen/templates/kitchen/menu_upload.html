{% extends 'kitchen/base.html' %} {% block content %}

<div class="max-w-6xl mx-auto pb-12 animate-fade-in-up">
 <!-- Header -->
 <div
  class="flex flex-col md:flex-row md:items-end justify-between gap-6 mb-10">
  <div>
   <div class="flex items-center gap-2 mb-2">
    <span
     class="inline-flex items-center justify-center w-10 h-10 rounded-xl bg-indigo-50 text-indigo-600 shadow-sm border border-indigo-100">
     <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path
       stroke-linecap="round"
       stroke-linejoin="round"
       stroke-width="2"
       d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
     </svg>
    </span>
    <span
     class="text-xs font-bold text-indigo-500 uppercase tracking-widest leading-none mt-0.5"
     >System Operations</span
    >
   </div>
   <h2
    class="text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-slate-900 to-slate-600 tracking-tight">
    Menu Data Import
   </h2>
   <p class="text-lg text-slate-500 font-medium mt-1">
    Bulk upload weekly menu rotations for vending units.
   </p>
  </div>
 </div>

 <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
  <!-- Left: Upload Zone -->
  <div class="lg:col-span-2">
   <div
    class="bg-white rounded-[2rem] shadow-xl shadow-slate-200/50 border border-slate-100 overflow-hidden relative">
    <div
     class="absolute inset-x-0 h-1 top-0 bg-gradient-to-r from-indigo-500 via-purple-500 to-indigo-500"></div>

    <div class="p-8 sm:p-10">
     <form
      method="post"
      enctype="multipart/form-data"
      class="space-y-8"
      id="uploadForm">
      {% csrf_token %}

      <div class="relative group">
       <label
        for="menu_file"
        class="block w-full h-64 border-2 border-dashed border-slate-300 rounded-3xl flex flex-col items-center justify-center cursor-pointer bg-slate-50/50 hover:bg-indigo-50/50 hover:border-indigo-400 transition-all duration-300 group-hover:scale-[1.01]">
        <div
         class="flex flex-col items-center justify-center pt-5 pb-6 text-center px-4">
         <div
          class="w-20 h-20 bg-white rounded-full shadow-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300">
          <svg
           class="w-10 h-10 text-indigo-500"
           fill="none"
           stroke="currentColor"
           viewBox="0 0 24 24">
           <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
          </svg>
         </div>
         <p class="mb-2 text-xl font-bold text-slate-700">
          Drop your file here or
          <span
           class="text-indigo-600 underline decoration-2 decoration-indigo-200 hover:decoration-indigo-500 transition-all"
           >browse</span
          >
         </p>
         <p class="text-sm text-slate-400 font-medium">
          Supports CSV, Excel (.xlsx, .xls)
         </p>
         <p
          id="fileName"
          class="mt-4 text-sm font-bold text-emerald-600 bg-emerald-50 px-3 py-1 rounded-full opacity-0 transition-opacity">
          No file selected
         </p>
        </div>
        <input
         type="file"
         name="menu_file"
         id="menu_file"
         accept=".csv, .xlsx, .xls"
         required
         class="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
         onchange="updateFileName(this)" />
       </label>
      </div>

      <button
       type="submit"
       class="w-full py-4 px-6 bg-slate-900 hover:bg-indigo-600 text-white font-bold text-lg rounded-xl shadow-lg hover:shadow-indigo-500/30 transform transition-all duration-200 active:scale-[0.98] flex items-center justify-center gap-3">
       <span>Initialize Data Import</span>
       <svg
        class="w-5 h-5"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24">
        <path
         stroke-linecap="round"
         stroke-linejoin="round"
         stroke-width="2"
         d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
       </svg>
      </button>
     </form>
    </div>
   </div>

   <!-- Console Output / Messages -->
   {% if messages %}
   <div
    class="mt-8 bg-slate-900 rounded-2xl shadow-xl overflow-hidden border border-slate-800">
    <div
     class="px-5 py-3 bg-slate-800 border-b border-slate-700 flex items-center gap-2">
     <div class="flex gap-1.5">
      <div class="w-2.5 h-2.5 rounded-full bg-red-500"></div>
      <div class="w-2.5 h-2.5 rounded-full bg-amber-500"></div>
      <div class="w-2.5 h-2.5 rounded-full bg-emerald-500"></div>
     </div>
     <span class="text-xs font-mono text-slate-400 ml-2"
      >system_output.log</span
     >
    </div>
    <div
     class="p-6 font-mono text-sm space-y-3 max-h-60 overflow-y-auto custom-scrollbar">
     {% for message in messages %}
     <div
      class="flex gap-3 {% if message.tags == 'success' %}text-emerald-400{% elif message.tags == 'error' %}text-red-400{% else %}text-blue-400{% endif %}">
      <span class="opacity-50 select-none">[{{ message.tags|upper }}]</span>
      <span>{{ message }}</span>
     </div>
     {% endfor %}
     <div class="text-slate-500 animate-pulse">_</div>
    </div>
   </div>
   {% endif %}
  </div>

  <!-- Right: Guide -->
  <div class="lg:col-span-1">
   <div
    class="bg-white rounded-3xl p-8 border border-slate-100 shadow-lg shadow-slate-100/50 sticky top-6">
    <div class="flex items-center gap-3 mb-6">
     <div class="p-2 bg-amber-50 rounded-lg text-amber-600">
      <svg
       class="w-6 h-6"
       fill="none"
       stroke="currentColor"
       viewBox="0 0 24 24">
       <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
      </svg>
     </div>
     <h3 class="text-xl font-bold text-slate-900">Format Spec</h3>
    </div>

    <p class="text-slate-500 text-sm mb-6 leading-relaxed">
     Ensure your dataset matches the required schema below. Case-sensitive
     headers are not required but order matters.
    </p>

    <div class="space-y-4">
     <div>
      <h4
       class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">
       Required Columns
      </h4>
      <div class="flex flex-wrap gap-2">
       <span
        class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-bold bg-slate-100 text-slate-700 border border-slate-200"
        >Week</span
       >
       <span
        class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-bold bg-slate-100 text-slate-700 border border-slate-200"
        >Day</span
       >
       <span
        class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-bold bg-slate-100 text-slate-700 border border-slate-200"
        >Item</span
       >
       <span
        class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-bold bg-slate-100 text-slate-700 border border-slate-200"
        >Price</span
       >
      </div>
     </div>

     <div>
      <h4
       class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">
       Nutrition Data
      </h4>
      <div class="flex flex-wrap gap-2">
       <span
        class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-bold bg-emerald-50 text-emerald-700 border border-emerald-100"
        >Calories</span
       >
       <span
        class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-bold bg-emerald-50 text-emerald-700 border border-emerald-100"
        >Protein</span
       >
       <span
        class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-bold bg-emerald-50 text-emerald-700 border border-emerald-100"
        >Carbs</span
       >
       <span
        class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-bold bg-emerald-50 text-emerald-700 border border-emerald-100"
        >Fats</span
       >
      </div>
     </div>

     <div class="pt-4 border-t border-slate-50">
      <a
       href="#"
       class="flex items-center text-sm font-bold text-indigo-600 hover:text-indigo-800 transition-colors">
       <svg
        class="w-4 h-4 mr-1.5"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24">
        <path
         stroke-linecap="round"
         stroke-linejoin="round"
         stroke-width="2"
         d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
       </svg>
       Download Template
      </a>
     </div>
    </div>
   </div>
  </div>
 </div>
</div>

<script>
 function updateFileName(input) {
  const fileNameElement = document.getElementById("fileName");
  if (input.files && input.files.length > 0) {
   fileNameElement.textContent = input.files[0].name;
   fileNameElement.classList.remove("opacity-0");
  } else {
   fileNameElement.textContent = "No file selected";
   fileNameElement.classList.add("opacity-0");
  }
 }
</script>

<style>
 @keyframes fadeInUp {
  from {
   opacity: 0;
   transform: translateY(10px);
  }
  to {
   opacity: 1;
   transform: translateY(0);
  }
 }
 .animate-fade-in-up {
  animation: fadeInUp 0.4s ease-out forwards;
 }
</style>

{% endblock %}
